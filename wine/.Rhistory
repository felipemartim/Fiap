scale_x_log10
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "blue")
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_histogram(fill = "blue")
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "yellow")
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "orange")
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "purple")
hist(quality)
str(wines)
par (mfrow=c(4,3))
hist(chlorides)
hist(sulphates)
hist(fixedacidity)
hist(freesulfurdioxide)
hist(alcohol)
hist(volatileacidity)
hist(totalsulfurdioxide)
hist(quality)
hist(citricacid)
hist(density)
hist(pH)
hist(residualsugar)
par (mfrow=c(1,1))
boxplot(freesulfurdioxide)
par (mfrow=c(4,3))
boxplot(chlorides)
boxplot(sulphates)
boxplot(fixedacidity)
boxplot(freesulfurdioxide)
boxplot(alcohol)
boxplot(volatileacidity)
boxplot(totalsulfurdioxide)
boxplot(quality)
boxplot(citricacid)
boxplot(density)
boxplot(pH)
boxplot(residualsugar)
par (mfrow=c(1,1))
par (mfrow=c(2,2))
boxplot(chlorides)
boxplot(sulphates)
boxplot(fixedacidity)
boxplot(freesulfurdioxide)
chlorides
log10(chlorides)
chlorides
hist(chlorides, log = 'x')
boxplot(chlorides, log = 'x')
boxplot(chlorides, log = 'y')
boxplot(chlorides, log = 'xy')
par (mfrow=c(1,1))
par (mfrow=c(2,2))
boxplot(chlorides, log = 'xy')
par (mfrow=c(1,1))
boxplot(chlorides, log = 'x')
boxplot(chlorides)
boxplot(chlorides, log = 'x')
boxplot(chlorides)
boxplot(chlorides, log = 'x')
?boxplot
boxplot(chlorides)
boxplot(chlorides, log = 'y')
boxplot(chlorides)
boxplot(chlorides, log = 'y')
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 50, fill = "red") +
scale_x_log10()
hist(chlorides)
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 50, fill = "red") +
scale_x_log10()
chlorides %>% log10() %>% hist()
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 50, fill = "red") +
scale_x_log10()
chlorides %>% log10() %>% hist(bins = 50)
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 50, fill = "red") +
scale_x_log10()
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 40, fill = "red") +
scale_x_log10()
?hist
chlorides %>% log10() %>% hist(breaks = 50)
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 40, fill = "red") +
scale_x_log10()
chlorides %>% log10() %>% hist(breaks = 50)
hist(sulphates)
chlorides %>% log10() %>% hist(breaks = 50)
chlorides %>% log10() %>% hist()
chlorides %>% logn() %>% hist()
chlorides %>% log() %>% hist()
chlorides %>% log10() %>% hist()
source('~/workspace/fiap/wine/linear_regression.R', echo=TRUE)
chlorides %>% log() %>% hist()
hist(chlorides)
hist(chlorides)
chlorides %>% log() %>% hist()
chlorides %>% log() %>% hist()
wines %>%
ggplot(aes(chlorides)) +
geom_histogram(bins = 40, fill = "red") +
scale_x_log()
?hist
chlorides %>% log() %>% hist(xname = 'chlorides')
?hist
chlorides %>% log() %>% hist(main = 'chlorides')
chlorides %>% log() %>% hist(xname = 'chlorides')
?hist
chlorides %>% log() %>% hist(xname = 'chlorides')
chlorides %>% log() %>% hist(main = 'chlorides')
hist(residualsugar)
residualsugar %>% log() %>% hist(main = 'residualsugar')
wines %>%
ggplot(aes(residualsugar)) +
geom_histogram(bins = 50, fill = "blue") +
scale_x_log10
wines %>%
ggplot(aes(residualsugar)) +
geom_histogram(bins = 50, fill = "blue") +
scale_x_log10
wines %>%
ggplot(aes(residualsugar)) +
geom_histogram(bins = 50, fill = "blue") +
scale_x_log10()
residualsugar %>% log() %>% hist(main = 'residualsugar')
wines %>%
ggplot(aes(residualsugar)) +
geom_histogram(bins = 50, fill = "blue") +
scale_x_log10()
residualsugar %>% log() %>% hist(main = 'residualsugar')
wines %>%
ggplot(aes(residualsugar)) +
geom_histogram(bins = 50, fill = "blue") +
scale_x_log10()
residualsugar %>% log() %>% hist(main = 'residualsugar')
hist(quality)
par (mfrow=c(4,3))
hist(chlorides)
hist(sulphates)
hist(fixedacidity)
hist(freesulfurdioxide)
hist(alcohol)
hist(volatileacidity)
hist(totalsulfurdioxide)
hist(quality)
hist(citricacid)
hist(density)
hist(pH)
hist(residualsugar)
par (mfrow=c(1,1))
chlorides %>% log() %>% hist(main = 'chlorides')
hist(chlorides)
chlorides %>% log() %>% hist(main = 'chlorides')
hist(residualsugar)
residualsugar %>% log() %>% hist(main = 'residualsugar')
par (mfrow=c(4,3))
hist(chlorides)
hist(sulphates)
hist(fixedacidity)
hist(freesulfurdioxide)
hist(alcohol)
hist(volatileacidity)
hist(totalsulfurdioxide)
hist(quality)
hist(citricacid)
hist(density)
hist(pH)
hist(residualsugar)
par (mfrow=c(1,1))
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "purple")
boxplot(quality ~Vinho, main='Vinho')
boxplot(quality ~Vinho, main='Tipo')
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "purple")
par (mfrow=c(2,2))
boxplot(chlorides)
boxplot(chlorides, log = 'y')
boxplot(sulphates)
boxplot(fixedacidity)
par (mfrow=c(1,1))
boxplot(chlorides, log = 'y')
par (mfrow=c(2,2))
boxplot(freesulfurdioxide)
boxplot(alcohol)
boxplot(volatileacidity)
boxplot(totalsulfurdioxide)
boxplot(freesulfurdioxide)
boxplot(alcohol)
boxplot(volatileacidity)
boxplot(totalsulfurdioxide)
boxplot(quality)
boxplot(citricacid)
boxplot(density)
boxplot(pH)
par (mfrow=c(1,1))
boxplot(residualsugar)
boxplot(residualsugar, log = 'y')
boxplot(quality)
boxplot(citricacid)
boxplot(density)
boxplot(pH)
par (mfrow=c(2,2))
boxplot(quality)
boxplot(citricacid)
boxplot(density)
boxplot(pH)
boxplot(freesulfurdioxide, main='freesulfurdioxide')
par (mfrow=c(2,2))
boxplot(quality, main='quality')
boxplot(citricacid, main='citricacid')
boxplot(density, main='density')
boxplot(pH, main='pH')
par (mfrow=c(1,1))
boxplot(residualsugar, log = 'y', main='residualsugar')
boxplot(chlorides)
boxplot(chlorides, log = 'y')
par (mfrow=c(2,2))
boxplot(chlorides, log = 'y')
boxplot(sulphates)
boxplot(fixedacidity)
boxplot(residualsugar, log = 'y', main='residualsugar')
par (mfrow=c(2,2))
boxplot(chlorides, log = 'y', main='chlorides')
boxplot(sulphates, main='sulphates')
boxplot(fixedacidity, main='fixedacidity')
boxplot(residualsugar, log = 'y', main='residualsugar')
boxplot(fixedacidity, main='fixedacidity', log = 'y')
par (mfrow=c(1,1))
boxplot(fixedacidity, main='fixedacidity', log = 'y')
wines %>%
select(-c(Vinho)) %>%
cor %>%
corrgram(type = "cor", lower.panel = panel.shade, upper.panel = panel.pie)
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
wines %>%
select(-c(Vinho)) %>%
cor %>%
corrgram(type = "cor", lower.panel = panel.shade, upper.panel = panel.pie)
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
chlorides %>% log() %>% hist(main = 'chlorides')
residualsugar %>% log() %>% hist(main = 'residualsugar')
wines %>%
ggplot(aes(quality, fill = quality)) +
geom_bar(fill = "purple")
wines %>%
select(-c(Vinho)) %>%
cor %>%
corrgram(type = "cor", lower.panel = panel.shade, upper.panel = panel.pie)
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2)
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
wines %>%
select(-c(Vinho)) %>%
cor %>%
corrgram(type = "cor", lower.panel = panel.shade, upper.panel = panel.pie)
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
#Gráfico de dispersao para a associação entre qualidade e álcool
plot (x = alcohol, y = qualidade,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
plot (x = alcohol, y = qualidade,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
#Gráfico de dispersao para a associação entre qualidade e álcool
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
plot (x = quality, y = alcohol,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
par (mfrow=c(2,2))
boxplot(freesulfurdioxide, main='freesulfurdioxide')
boxplot(alcohol, main='alcohol')
boxplot(volatileacidity, main='volatileacidity')
boxplot(totalsulfurdioxide, main='totalsulfurdioxide')
#Gráfico de dispersao para a associação entre qualidade e álcool
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
par (mfrow=c(1,1))
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
?ggpairs
wines %>%
select(-c(Vinho)) %>%
ggpairs()
wines %>%
select(-c(Vinho)) %>%
ggpairs()
summary(wines)
#Gráfico de dispersao para a associação entre qualidade e álcool
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
wines %>%
select(-Vinho) %>%
ggcorr(method = c("pairwise","spearman"), label = FALSE, angle = -0, hjust = 0.2) +
coord_flip()
par (mfrow=c(1,1))
plot (x = alcohol, y = quality,
main = "Gráfico de dispersão",
xlab = "Alcohol",
ylab = "Quality")
wines %>%
select(-c(Vinho)) %>%
ggpairs()
smp_size <- floor(0.75 * nrow(wines))
set.seed(2019)
train_ind <- sample(seq_len(nrow(wines)), size = smp_size)
train <- wines[train_ind, ]
test <- wines[-train_ind, ]
?seq_len
seq_len(nrow(wines)
seq_len(nrow(wines))
seq_len(nrow(wines))
sample(seq_len(nrow(wines)), size = smp_size)
str(wines)
modelo01 <- lm(quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
stepwise<-step(modelo01,direction="both")
stepwise
summary(stepwise)
Val_pred <- predict(modelo01,interval = "prediction", level = 0.95)
View(Val_pred)
View(Val_pred)
# intervalo de confianca - grafico para media
fit <- Val_pred[,1] # Salario es preditos
lower <- Val_pred[,2] # limite inferior
upper <- Val_pred[,3] # limite superior
mse <- mean((salarios$salario  - fit)^2)
sqrt(mse)
mse <- mean((quality - fit)^2)
sqrt(mse)
erro_usando_media <- mean((quality  - mean(quality ))^2)
sqrt(erro_usando_media)
summary(modelo01)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
Val_pred <- predict(modelo01, test)
View(Val_pred)
Val_pred <- predict(modelo01, interval = "prediction", level = 0.95)
View(Val_pred)
Val_pred <- predict(modelo01, test)
View(Val_pred)
actuals_preds <- data.frame(cbind(actuals=test$quality, predicteds=Val_pred))  # make actuals_predicteds dataframe.
correlation_accuracy <- cor(actuals_preds)
correlation_accuracy
head(actuals_preds)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
Val_pred <- predict(modelo01, test)
View(Val_pred)
actuals_preds <- data.frame(cbind(actuals=test$quality, predicteds=Val_pred))  # make actuals_predicteds dataframe.
correlation_accuracy <- cor(actuals_preds)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
Val_pred <- predict(modelo01, test)
actuals_preds <- data.frame(cbind(actuals=test$quality, predicteds=Val_pred))  # make actuals_predicteds dataframe.
correlation_accuracy <- cor(actuals_preds)  # 82.7%
correlation_accuracy
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ residualsugar
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
Val_pred <- predict(modelo01, test)
actuals_preds <- data.frame(cbind(actuals=test$quality, predicteds=Val_pred))  # make actuals_predicteds dataframe.
correlation_accuracy <- cor(actuals_preds)  # 82.7%
correlation_accuracy
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ residualsugar
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
summary(modelo01)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ residualsugar
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
smp_size <- floor(0.75 * nrow(wines))
set.seed(2019)
train_ind <- sample(seq_len(nrow(wines)), size = smp_size)
train <- wines[train_ind, ]
test <- wines[-train_ind, ]
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~  residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~
freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
modelo01 <- lm(train$quality ~ alcohol)
modelo01 <- lm(train$quality ~ alcohol)
summary(modelo01)
View(modelo01)
train
smp_size <- floor(0.75 * nrow(wines))
set.seed(2019)
train_ind <- sample(seq_len(nrow(wines)), size = smp_size)
train <- wines[train_ind, ]
test <- wines[-train_ind, ]
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
wines <- read.csv2(file="BaseWine_Red_e_White.csv"
, header=TRUE
, sep=";"
, colClasses=c("integer", rep("numeric", 5), rep("numeric", 6), "integer", "factor"))
smp_size <- floor(0.75 * nrow(wines))
set.seed(2019)
train_ind <- sample(seq_len(nrow(wines)), size = smp_size)
train <- wines[train_ind, ]
test <- wines[-train_ind, ]
modelo01 <- lm(train$quality ~ fixedacidity + volatileacidity
+ citricacid + residualsugar + chlorides
+ freesulfurdioxide + totalsulfurdioxide
+ density + pH + sulphates + alcohol + Vinho)
